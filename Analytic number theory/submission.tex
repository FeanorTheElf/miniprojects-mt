\documentclass{scrartcl}

\usepackage{graphicx}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[english]{babel}
\usepackage{amsmath}
\usepackage{mathtools}
\usepackage{amssymb}
\usepackage{listings}
\usepackage{amsthm}
\usepackage[style=english]{csquotes}
\usepackage[language=english, backend=biber, style=alphabetic, sorting=nyt]{biblatex}

\addbibresource{bibliography.bib}

\title{Miniproject - Analytic Number Theory}
\author{Simon Pohmann}
\date{}

\newcommand{\primes}{\mathbb{P}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\divides}{\ | \ }
\newcommand{\units}{\times}
\newcommand{\sgn}{\mathrm{sgn}}
\newcommand\restr[2]{{
    \left.\kern-\nulldelimiterspace
    #1
    \vphantom{\big|}
    \right|_{#2}
}}

\theoremstyle{definition}
\newtheorem{definition}{Definition}
\newtheorem{lemma}[definition]{Lemma}
\newtheorem{remark}[definition]{Remark}
\newtheorem{proposition}[definition]{Proposition}
\newtheorem{example}[definition]{Example}
\newtheorem{corollary}[definition]{Corollary}

\begin{document}
\maketitle
We use the convention that $\N = \{ n \in \Z \ | \ n \geq 0 \}$.
Further, we write $a \divides b$ if $a$ divides $b$ and $a \perp b$ if $a$ and $b$ are coprime.
Finally, let $\primes$ be the set of prime numbers in $\N$.

\section{Part I}

For convenience, we include the definition of a Dirichlet character from the task description first.
\begin{definition}
    Let $q \geq 2$, then a \emph{Dirichlet character (modulo $q$)} is a function $\chi: \N \to \C$ such that
    \begin{itemize}
        \item $\chi$ is completely multiplicative, so $\chi(a)\chi(b) = \chi(ab)$
        \item $\chi$ is periodic modulo $q$, so $\chi(n + q) = \chi(n)$
        \item $\chi(n) \neq 0$ if and only if $n \perp q$
    \end{itemize}
\end{definition}
First, we will give another characterization of Dirichlet characters.
\begin{lemma}[Characterization of Dirichlet characters]
    \label{prop:characterization_dirichlet_character}
    We have a one-to-one correspondence between Dirichlet characters modulo $q$ and group homomorphisms $(\Z/q\Z)^\units \to \C^\units$ via
    \begin{align*}
        \{ f: (\Z/q\Z)^\units \to \C^\units \ | \ f \ \text{group hom} \} &\to \{ \chi: \N \to \C \ | \ \chi \ \text{Dirichlet character mod $q$} \} \\
        f &\mapsto \chi_f := \left( \N \to \C, \ n \mapsto \begin{cases}
            f([n]) & \text{if $n \perp q$} \\
            0 & \text{otherwise}
        \end{cases} \right)
    \end{align*}
\end{lemma}
\begin{proof}
    First of all, we show that the map is well-defined. Let $f: (\Z/q\Z)^\units \to \C^\units$ be a (multiplicative) group homomorphism, and we show that $\chi_f$ is a Dirichlet character.
    
    Note that property (ii) and (iii) directly follow from the definition, as $\chi_f(n)$ only depends on the value of $n$ modulo $q$.
    So consider some $a, b \in \N$.
    If both $a \perp q$ and $b \perp q$ then
    \begin{equation*}
        \chi_f(a)\chi_f(b) = \chi([a])\chi([b]) = \chi([ab]) = \chi_f(ab)
    \end{equation*}
    as also $ab \perp q$.

    On the other hand, if $a \not\perp q$ or $b \not\perp q$ have $\chi_f(a) = 0$ resp. $\chi_f(b) = 0$.
    We also have in this case that $ab \not\perp q$ and so
    \begin{equation*}
        \chi_f(a)\chi_f(b) = 0 = \chi_f(ab)
    \end{equation*}
    Now it is left to show that the correspondence is a bijection.
    Clearly, if $f \neq g$ then $f(x) \neq g(x)$ for some $x \in (\Z/q\Z)^\units$ and so $\chi_f(n) \neq \chi_g(n)$ for some representative $n \in \N$ of $x$.
    
    To show surjectivity, consider some Dirichlet character $\chi: \N \to \C$ and construct a group homomorphism $f: (\Z/q\Z)^\units \to \C^\units$. 
    For each $x \in (\Z/q\Z)^\units$, there is a representative $n \in \N$ of $x$ and as $\chi(n)$ does not depend on the choice of $n$, we may define $f(x) := \chi(n)$.
    Note that as $x \in (\Z/q\Z)^\units$, we find $n \perp q$ and so $\chi(n) \neq 0$, i.e. $\chi(n) \in \C^*$.
    Then clearly for $a, b \in (\Z/q\Z)^*$ with representatives $n, m \in \N$ have
    \begin{equation*}
        f(ab) = \chi(nm) = \chi(n)\chi(m) = f(a)f(b)
    \end{equation*}
    So $f$ is a well-defined group homomorphism and we obviously have $\chi_f = \chi$.
\end{proof}
For simplicity of notation we sometimes will identify a Dirichlet character and its group homomorphism if it is always clear which one is meant.
\begin{example}[Question (i)]
    \label{ex:nontrivial_dirichlet_character_mod_4}
    The function
    \begin{equation*}
        f: \N \to \C, \quad n \mapsto \begin{cases}
            0 & \text{if $n \equiv 0, 2 \pmod 4$} \\
            1 & \text{if $n \equiv 1 \pmod 4$} \\
            -1 & \text{if $n \equiv 3 \pmod 4$}
        \end{cases}
    \end{equation*}
    is a Dirichlet character.
\end{example}
\begin{proof}
    This follows directly from Lemma~\ref{prop:characterization_dirichlet_character}, as $f = \chi_g$ for the group homomorphism
    \begin{equation*}
        g: (\Z/4\Z)^\units = \{ 1, 3 \} \to \C^*, \quad 1 \mapsto 1, \ 3 \mapsto -1
    \end{equation*}
    (this is a group homomorphism, as $3^2 = 9 \equiv 1 \pmod 4$)
\end{proof}
Now we want to define Dirichlet series of Dirichlet characters.
\begin{proposition}
    For a Dirichlet character $\chi: \N \to \C$ and some $\epsilon > 0$, the series
    \begin{equation*}
        L(s, \chi) := \sum_{n \geq 1} \chi(n) n^{-s}
    \end{equation*}
    converges uniformly on $\Re(s) \geq 1 + \epsilon$.
    We will call it the Dirichlet series of $\chi$.
\end{proposition}
\begin{proof}
    By Lemma~\ref{prop:characterization_dirichlet_character}, we know that $\chi$ corresponds to a group homomorphism
    \begin{equation*}
        f: (\Z/q\Z)^\units \to \C^\units
    \end{equation*}
    such that $\chi(\N) = f((\Z/q\Z)^*) \cup \{ 0 \} \subseteq \C$ is a finite subset of $\C$.
    Hence, there is $C > 0$ with $|\chi(n)| \leq C$ for all $n \in \N$, and it follows that
    \begin{equation*}
        \sum_{1 \leq n \leq X} \left| \chi(n) n^{-s} \right| \leq \sum_{1 \leq n \leq X} C \left| n^{-s} \right| \leq C \sum_{1 \leq n \leq X} \left| n^{-s} \right|
    \end{equation*}
    We know that the series
    \begin{equation*}
        \sum_{n \geq 1} n^{-s}
    \end{equation*}
    converges uniformly on $\Re(s) \geq 1 + \epsilon$ and so the claim follows.
\end{proof}
\begin{proposition}
    \label{prop:dirichlet_series_at_one}
    Let $f: (\Z/q\Z)^\units \to \C^\units$ be a group homomorphism. Then for the associated Dirichlet character $\chi = \chi_f$ we have that
    \begin{equation*}
        \lim_{s \to 1^+} L(s, \chi) \ \text{exists} \ \Leftrightarrow \ \sum_{x \in (\Z/q\Z)^\units} f(x) = 0
    \end{equation*}
    If this is the case, then
    \begin{equation*}
        \lim_{s \to 1^+} L(s, \chi) = \sum_{n \geq 1} \frac {\chi(n)} n
    \end{equation*}
    where the right-hand side converges (but not absolutely).
\end{proposition}
\begin{proof}
    Let $c = \sum_{x \in (\Z/q\Z)^\units} f(x)$.
    For the direction $\Rightarrow$ assume that $c \neq 0$.
    Then have for $\Re(s) > 1$ that
    \begin{align*}
        \sgn(c) \sum_{n \geq 1} \chi(n) n^{-s} &= \sum_{n \geq 0} \ \sum_{0 < k \leq q} \sgn(c) \chi(qn + k) (qn + k)^{-s} \\
        &\geq \sum_{n \geq 0} \ \sum_{0 < k \leq q}\sgn(c) \chi(qn + k) (qn + n)^{-s} \\
        &= \sum_{n \geq 0} \sgn(c) (qn + n)^{-s} \underbrace{\sum_{0 < k \leq q} \chi(qn + k)}_{= c} \\
        &\geq \frac {|c|} {(q + 1)^s} \sum_{n \geq 1} n^{-s} = \frac {|c|} {(q + 1)^s} \zeta(s)
    \end{align*}
    which clearly has a pole at $s = 1$. Hence $\lim_{s \to 1^+} L(s, \chi_f)$ cannot exist.

    For the other direction, assume that $c = 0$.
    We will only consider real $s$ now.
    Observe that by Bernoulli's inequality, have for $0 < s \leq 1$ that
    \begin{align*}
        (qn)^{-s} - (qn + k)^{-s} &= \frac {(qn + k)^s - (qn)^s} {(q^2n^2 + qnk)^s} = (qn)^{s} \frac {(1 + k(qn)^{-1})^s - 1} {(q^2n^2 + qnk)^s} \\
        &\leq (qn)^s \frac {sk(qn)^{-1}} {(q^2n^2 + qnk)^s} = \frac {sk} {qn(qn + k)^s} = O(sn^{-s - 1})
    \end{align*}
    If $s > 1$ and $k \leq q$, then also $(qn)^{-s} - (qn + k)^{-s} = O(sn^{-(1 + \epsilon)})$ for some small enough $0 < \epsilon < 1$.
    As $\chi((\Z/q\Z)^\units) \subseteq \C$ is finite, find $C > 0$ with $|\chi_f(n)| \leq C$ for all $n \in \N$. 
    Then for all $s \geq \epsilon$ and $X \leq Y$ it holds
    \begin{align*}
        &\sum_{X \leq n \leq Y} \chi(n) n^{-s} \\
        =& \ O(qCX^{-s} + qCY^{-s}) + \sum_{X/q \leq n \leq Y/q} \ \sum_{0 < k \leq q} \chi(qn + k) \Bigl( (qn)^{-s} + \underbrace{(qn + k)^{-s} - (qn)^{-s}}_{= O(sn^{-(1 + \epsilon)})} \Bigr) \\
        =& \ O(qCX^{-s}) + \sum_{X/q \leq n \leq Y/q} \Bigl( (qn)^{-s} c + \sum_{0 < k \leq q} O(Csn^{-(1 + \epsilon)}) \Bigr) = \\
        =& \ O(qCX^{-s}) + 0 + O\Bigl( Cqs \sum_{X/q \leq n \leq Y/q} n^{-(1 + \epsilon)} \Bigr) \\
        =& \ O(qCX^{-s}) + O\Bigl( Cqs \sum_{n \geq X/q} n^{-(1 + \epsilon)} \Bigr)
    \end{align*}
    which is well-defined and finite.
    Further, the expression converges uniformly (as a function in $s$ on $[\epsilon, \infty[$) to $0$ as $X \to \infty$. 
    So
    \begin{equation*}
        \sum_{n < X} \chi(n) n^{-s} \quad \text{converges uniformly to} \quad \sum_{n \geq 1} \chi(n) n^{-s}
    \end{equation*}
    as $X \to \infty$ (on $[\epsilon, \infty[$). 
    Thus the limit is continuous and extends $L(s, \chi_f)$ defined on $]1, \infty[$.
    It follows that $\lim_{t \to s^+} L(t, \chi_f)$ exists and is equal to $\sum_{n \geq 1} \chi(n) n^{-s}$.
\end{proof}
Applied to our example, we find
\begin{example}[Question (ii)]
    Let $f: \N \to \C$ be the Dirichlet character from Example~\ref{ex:nontrivial_dirichlet_character_mod_4} with corresponding group homomorphism $g: (\Z/4\Z)^\units \to \C$.
    Then
    \begin{equation*}
        \sum_{x \in (\Z/4\Z)^*} g(x) = g(1) + g(3) = 1 - 1 = 0
    \end{equation*}
    and so by Lemma~\ref{prop:dirichlet_series_at_one} the limit $\lim_{s \to 1^+} L(s, f)$ exists.
    The lemma further yields that
    \begin{align*}
        \lim_{s \to 1} L(s, f) &= \sum_{n \geq 1} f(n) n^{-1} = \sum_{n \geq 0} \frac {f(4n + 1)} {4n + 1} + \frac {f(4n + 3)} {4n + 3} = \sum_{n \geq 0} \frac 1 {4n + 1} - \frac 1 {4n + 3} \\
        &= 2 \sum_{n \geq 0} \frac 1 {(4n + 1)(4n + 3)} > 0
    \end{align*}
    is positive. 
    Wolfram Alpha \cite{wolfram_alpha} can give an explicit value to this sum, using the digamma function $\psi$. Namely
    \begin{equation*}
        \sum_{x \in (\Z/4\Z)^\units} f(n) n^{-1} = \frac 1 4 (\psi(\frac 7 4) - \psi(\frac 5 4))
    \end{equation*}
    which seems to be $\frac 1 4$.
\end{example}
Interestingly, we can also study the series
\begin{equation*}
    \sum_p f(p) p^{-s}
\end{equation*}
using Euler Products.
\begin{example}[Question (ii)]
    \label{ex:dirichlet_sum_over_primes}
    Have for $\Re(s) > 1$ that
    \begin{equation*}
        \sum_p \frac {f(p)} {p^s} = \log( L(f, s) ) + O( \zeta(2\Re(s)) )
    \end{equation*}
    In particular, we see that
    \begin{equation*}
        \lim_{s \to 1^+} \sum_p \frac {f(p)} {p^s}
    \end{equation*}
    exists.
\end{example}
\begin{proof}
    By Taylor series expansion, see that
    \begin{equation*}
        \log(1 - x) = -x + O(|x|^2)
    \end{equation*}
    Hence for $\Re(s) > 1$ we can consider the logarithm of the Euler Product to find
    \begin{align*}
        \log( L(f, s) ) =& \log\Bigl( \prod_p \sum_{k \geq 0} \frac {f(p^k)} {p^{ks}} \Bigr) = \log\Bigl( \prod_p \frac 1 {1 - f(p)/p^s} \Bigr) \\
        =& \sum_p -\log\Bigl( 1 - \frac {f(p)} {p^s} \Bigr) = \sum_p \frac {f(p)} {p^s} + O\Bigl( \frac {f(p)^2} {p^{2\Re(s)}} \Bigr) \\
        = & \sum_p \frac {f(p)} {p^s} + O\Bigl( \underbrace{\sum_p \frac {f(p)} {p^{2\Re(s)}}}_{\leq \zeta(2\Re(s))} \Bigr) = \sum_p \frac {f(p)} {p^s} + O(\zeta(2\Re(s)))
    \end{align*}
\end{proof}
\begin{lemma}
    \label{prop:prime_factor_3_mod_4}
    Let $n \equiv 3 \pmod 4$. Then $n$ has a prime factor $p \equiv 3 \pmod 4$.
\end{lemma}
\begin{proof}
    Use induction on $n$.
    If $n = 3$, the claim is trivial. 
    So let $n > 3$. If $n$ is prime, the claim again follows.
    Otherwise, have $n = ab$ with nontrivial divisors $a, b$.
    However, $3 \equiv n$ is not a square modulo $4$, so find that $a \not\equiv b \pmod 4$.
    As both $a$ and $b$ must be odd, we see that either $a \equiv 3$ or $b \equiv 3 \pmod 4$ and the claim follows by the induction hypothesis.
\end{proof}
\begin{corollary}[Question (iii)]
    There are infinitely many primes $p$ with $p \equiv 3 \pmod 4$.
\end{corollary}
\begin{proof}
    Assume there were only finitely many, say $p_1, ..., p_N$.
    Let $P := p_1 ... p_N$ if $N$ is even and $P := p_1^2 p_2 ... p_N$ if $N$ is odd.
    Then
    \begin{equation*}
        P \equiv 3^{2 \lceil \frac N 2 \rceil} \equiv 1^{\lceil \frac N 2 \rceil} = 1 \pmod 4
    \end{equation*}
    Thus, by Lemma~\ref{prop:prime_factor_3_mod_4}, $P + 2$ has a prime factor $q \equiv 3 \pmod 4$.
    However, $q \neq p_i$ as $p_i \perp P + 2$ for all $i$ (if $p_i \divides P + 2$, then $p_i \divides P + 2 - P = 2$, a contradiction).
    This contradicts our assumption.
\end{proof}
For the case of primes $\equiv 1 \pmod 4$, I have remembered Fermat's theorem on the sum of two squares and its connection to primes in the ring $\Z[i]$ of Gaussian integers, and somehow my train of thoughts went into Algebraic Number Theory.
After some research, I have found an exercise in \cite[Chapter I, §10]{neukirch} that requires the reader to prove the following proposition.
\begin{proposition}
    \label{prop:primes_1_mod_q}
    Let $q \geq 3$ be an integer.
    Then there are infinitely many primes $p$ with $p \equiv 1 \pmod q$.
\end{proposition}
\begin{proof}
    Assume there were only finitely many such primes $p_i$, then we have their product $P = \prod_i p_i \in \Z$.
    Consider now the $q$-th cyclotomic polynomial $\Phi_q$.
    Clearly $\Phi_q(qPX) - 1 \in \Q[X]$ has at most $\phi(q)$ zeros, so there exists some $x \in \Z$ with $\Phi_q(qPx) \neq 1$ (this ``Ansatz'' was given as a hint).

    Let now $K = \Q(\omega_q)$ be the $q$-th cyclotomic number field with a primitive $q$-th root of unity $\omega_q$ (i.e. $\Phi_q(\omega_q) = 0$).
    Let further $\mathcal{O} \subseteq K$ be the ring of integral elements over $\Z$ in $K$.
    The prime decomposition law for Dedekind ring extension \cite[Chapter I, Prop 8.3]{neukirch} tells us that for a prime $p$, the ideal $(p)$ is reducible in $\mathcal{O}$ if and only if $\Phi_q$ is reducible modulo $p$.
    As $(\Z/p\Z)^\units$ is cyclic of order $p - 1$, this is the case if and only if $q \divides p - 1$, i.e. $p \equiv 1 \pmod q$.

    Now consider the element $\alpha = \omega_q - xqP \in \mathcal{O}$. Then
    \begin{align*}
        N_{K/\Q}(\alpha) &= \prod_{\sigma: K \to \C \ \text{$\Q$-field homomorphism}} \sigma(\omega_q - xqP) \\
        &= \prod_{\sigma} (\sigma(\omega_q) - xqP) = \mathrm{MiPo}_\Q(\omega_q)(xqP) = \Phi_q(xqP) \neq 1
    \end{align*}
    as $\mathrm{MiPo}_\Q(\omega_q) = \prod_\sigma (\sigma(\omega_q) - X)$.
    Hence, $\alpha$ is not a unit in $\mathcal{O}$.
    On the other hand, $(\alpha)$ is coprime to $(p_i)$ for each $p_i$, as 
    \begin{equation*}
        \omega_q = \alpha - xqP \in (\alpha) + (p_i) \quad \text{and} \quad \omega_q \in \mathcal{O}^\units
    \end{equation*}
    By our assumption, the only prime ideals in $\mathcal{O}$ are the prime ideal factors of $(p_i)$ and $(p)$ for $p \neq p_i$.
    Thus, the prime ideal factorization of $(\alpha)$ consists only of prime ideals $(p), p \neq p_i$ and it follows that $(\alpha) = (n)$ for some integer $n \geq 2$.
    As $\omega_q$ and $xqP \in \Z$ are $\Q$-linearly independent, we see that $n \divides \omega_q$ and $n \divides xqP$.
    However, the former is a contradiction, as $\omega_q \in \mathcal{O}^\units$ is a unit and no $n \geq 2$ is a unit.
\end{proof}
In a later chapter, the book also proves the general result \cite[Chapter VII, Theorem 5.14]{neukirch}.
I am pretty sure that those are exactly the functions $L(\chi, s)$ that we defined above.
\begin{corollary}[Question (iii)]
    There are infinitely many primes $p$ with $p \equiv 1 \pmod 4$.
\end{corollary}
\begin{proof}
    This is just a special case of Prop.~\ref{prop:primes_1_mod_q}.
\end{proof}
\begin{example}[Question (iii)]
    Using a computer, we can also study the actual frequency of prime numbers $\equiv 1, 3 \pmod 4$ among e.g. the first $10^8$ integers.
    This seems to indicate that both numbers are asymptotically equal, which seems natural, given the result of Example~\ref{ex:dirichlet_sum_over_primes}.
    For example, there are 332180 primes $\equiv 1 \pmod 4$ and 332398 primes $\equiv 3$ smaller than $10^8$.
    To find these numbers, the following python code was used.
    \lstinputlisting[language = python]{./primes.py}
\end{example}

\section{Part II}
We have already shown that Dirichlet characters are, in principle, group homomorphisms $(\Z/q\Z)^\units \to \C^\units$.
If we now assume $q$ to be prime, we get an even nicer characterization.
So for the whole section, assume that $q \geq 3$ is a prime.
\begin{corollary}[Question (i)]
    \label{prop:dirichlet_character_image_group}
    Let $\chi, \chi': \N \to \C$ be Dirichlet characters mod $q$ and $r$ a representative of a primitive root modulo $q$.
    If $\chi(r) = \chi'(r)$, then $\chi = \chi'$.
    Further, have that $\chi(n)^{q - 1} = 1$ for all $n \in \N$ with $n \perp q$.
\end{corollary}
\begin{proof}
    The properties follow directly from Lemma~\ref{prop:characterization_dirichlet_character}.
    Let $f, f': (\Z/q\Z)^\units \to \C^\units$ be the associated group homomorphisms of $\chi, \chi'$ as in Lemma~\ref{prop:characterization_dirichlet_character}.
    If $f([r]) = \chi(r) = \chi'(r) = f'([r])$ then clearly $f = f'$, as these are group homomorphisms and $\langle [r] \rangle = (\Z/q\Z)^\units$.
    Hence $\chi = \chi'$.

    Further, have for $n \in \N$ with $n \perp q$ that $[n] \in (\Z/q\Z)^\units$ and thus
    \begin{equation*}
        [n]^{q - 1} = [n]^{\phi(q)} = [n]^{|(\Z/q\Z)^\units|} = 1 
    \end{equation*}
    As $f$ is a group homomorphism, find
    \begin{equation*}
        \chi(n)^{q - 1} = f([n])^{q - 1} = f([n]^{q - 1}) = f(1) = 1
    \end{equation*}
\end{proof}
This correspondence also works in the other direction.
\begin{corollary}[Question (ii)]
    \label{prop:dirichlet_character_primitive_root}
    Let $\omega \in \C$ be a $(q - 1)$-th root of unity, i.e. $\omega^{q - 1} = 1$ and let $r \in \Z$ be a representative of a primitive root modulo $q$.
    Then
    \begin{equation*}
        g: \N \to \C, \quad n \mapsto \begin{cases}
            \omega^{\log_r n} & \text{if $n \perp q$} \\
            0 & \text{otherwise}
        \end{cases}
    \end{equation*}
    is a well-defined Dirichlet character.
\end{corollary}
\begin{proof}
    Follows again directly from Lemma~\ref{prop:characterization_dirichlet_character}, as $[r] \mapsto \omega$ induces a unique group homomorphism $(\Z/q\Z)^\units \to \C^\units$.
    The associated Dirichlet character is obviously $g$.
\end{proof}
Note that the image of a group homomorphism $f: (\Z/q\Z)^\units \to \C^\units$ is a subgroup of $\C^\units$.
Using Corollary~\ref{prop:dirichlet_character_image_group}, we can describe it quite concretely.
\begin{proposition}
    Let $\chi: \N \to \C$ be a Dirichlet character with group homomorphism $f: (\Z/q\Z)^\units \to \C^\units$.
    Then $\mathrm{im}f \leq S$ is a subgroup where $S_q := \{ \omega_q^k \ | \ k \in \Z \}$ is the group of $q$-th roots of unity.
    
    It is a fact from Algebra that $S_q \cong (\Z/q\Z)^\units$, hence Dirichlet characters modulo a prime $q$ are in 1-to-1 correspondence with the endomorphisms $\mathrm{End}((\Z/q\Z)^\units)$ of $(\Z/q\Z)^\units$.
\end{proposition}
\begin{proof}
    We have that $S_q = \{ x \in \C^\units \ | \ x^{q - 1} = 1 \}$ and the claim directly follows from Corollary~\ref{prop:dirichlet_character_image_group}.
\end{proof}
Note that the endomorphisms $\mathrm{End}((\Z/q\Z)^\units)$ form a ring w.r.t. pointwise multiplication and composition
(this is the case for the endomorphisms of any abelian group).
In particular, the endomorphisms and so the Dirichlet characters form a group w.r.t. pointwise multiplication.
\begin{definition}
    Denote by $\mathrm{Dir}(q)$ the set of Dirichlet characters modulo $q$.
\end{definition}
By Corollary~\ref{prop:dirichlet_character_image_group} each Dirichlet character resp. group endomorphism of $(\Z/q\Z)^\units$ is determined by its value at a primitive root of unity $r \in (\Z/q\Z)^\units$.
Further, by Corollary~\ref{prop:dirichlet_character_primitive_root}, we also have a Dirichlet character resp. group endomorphism for each possible value at a primitive root of unity.
Hence
\begin{equation*}
    |\mathrm{Dir}(q)| = |\mathrm{End}((\Z/q\Z)^\units)| = |(\Z/q\Z)^\units| = q - 1
\end{equation*}
It follows that there are exactly $q - 1$ distinct Dirichlet characters modulo a prime $q$.
\begin{remark}
    It is again a fact that $(\Z/p^k\Z)^\units$ is cyclic for an odd prime $p$ and $k \geq 1$.
    Hence, everything up to now can also be done for odd prime powers, if we replace $q - 1$ by $\phi(q)$.
\end{remark}
Because of Lemma~\ref{prop:dirichlet_series_at_one} it might seem like a good idea to study in which cases the value $\sum_{x \in (\Z/q\Z)^\units} \chi(x)$ is zero.
\begin{proposition}[Question (iii)]
    \label{prop:finite_sums_characters}
    Let $\chi_0$ be the trivial Dirichlet character given by $r \mapsto 1$.
    Then
    \begin{align*}
        \sum_{a \in (\Z/q\Z)^\units} \chi(a) &= \begin{cases}
            q - 1 & \text{if $\chi = \chi_0$} \\
            0 & \text{otherwise}
        \end{cases}, \\
        \sum_{\chi \in \mathrm{Dir}(q)} \chi(a) &= \begin{cases}
            q - 1 & \text{if $a \equiv 1 \pmod q$} \\
            0 & \text{otherwise}
        \end{cases}
    \end{align*}
    Furthermore, for $b \perp q$ have
    \begin{equation*}
        \sum_{\chi \in \mathrm{Dir}(q)} \chi(a)\overline{\chi(b)} = \begin{cases}
            q - 1 & \text{if $a \equiv b \pmod q$} \\
            0 & \text{otherwise}
        \end{cases}
    \end{equation*}
\end{proposition}
\begin{proof}
    Clearly
    \begin{equation*}
        \sum_{a \in (\Z/q\Z)^\units} \chi_0(a) = q - 1 \quad \text{and} \quad \sum_{\chi \in \mathrm{Dir}(q)} \chi(1) = \sum_{\chi \in \mathrm{Dir}(q)} 1 = q - 1
    \end{equation*}
    So it is left to show that we get zero in the other cases.
    
    Consider a Dirichlet character $\chi \neq \chi_0$ given by $r \mapsto \xi$ for a primitive $q$-th root of unity $\xi \neq 1$.
    Then
    \begin{equation*}
        \sum_{a \in (\Z/q\Z)^\units} \chi(a) = \sum_{k = 0}^{q - 2} \chi(r^k) = \sum_{k = 0}^{q - 2} \xi^k = \frac {1 - \xi^{q - 1}} {q - \xi} = 0 
    \end{equation*}
    By using the earlier results on the structure of $\mathrm{Dir}(q)$ we see that for $a \equiv r^k \not\equiv 1 \pmod q$, have
    \begin{align*}
        \sum_{\chi \in \mathrm{Dir}(q)} \chi(a) &= \sum_{\chi \in \mathrm{Dir}(q)} \chi(r)^k \\
        &= \sum_{\xi \ \text{$q$-th root of unity}} \xi^k = \sum_{l = 0}^{q - 2} \omega^{kl} = \frac {1 - (\omega^{q - 1})^k} {1 - \omega^k} = 0 
    \end{align*}
    where $\omega \in \C$ is any primitive $q$-th root of unity and $r \in \Z$ is a primitive root modulo $q$.
    
    For the last part, note that for any $q$-th root of unity $\xi$, we have $\xi\overline{\xi} \in \R$ with $\xi\overline{\xi} = |\xi|^2 > 0$.
    Furthermore, $\overline{\xi}$ is also a $q$-th root of unity, and so we see that $\xi\overline{\xi} = 1$ (the only real, positive root of unity is 1).
    It follows that for any Dirichlet character $\chi$ have $\overline{\chi([a])} = \chi([a]^{-1})$.
    Thus
    \begin{equation*}
        \sum_{\chi \in \mathrm{Dir}(q)} \chi(a)\overline{\chi(b)} = \sum_{\chi \in \mathrm{Dir}(q)} \chi([a][b]^{-1}) = \begin{cases}
            q - 1 & \text{if $[a][b]^{-1} = 1 \in (\Z/q\Z)^\units$} \\
            0 & \text{otherwise}
        \end{cases}
    \end{equation*}
    The condition $ab^{-1} = 1$ is equivalent to $a \equiv b \pmod q$, so the claim follows.
\end{proof}
Using these basic results, we can now prove facts on the Dirichlet series of characters.
\begin{proposition}[Question (iv)]
    \label{prop:representation_mangoldt_series_congruent_a}
    Let $a \perp q$. Then for $\Re(s) > 1$ have
    \begin{equation*}
        \sum_{n \equiv a \ (\text{mod} \ q)} \frac {\Lambda(n)} {n^s} = \frac 1 {q - 1} \sum_{\chi \in \mathrm{Dir}(q)} \overline{\chi(a)} \sum_{n \geq 1} \frac {\Lambda(n) \chi(n)} {n^s}
    \end{equation*}
    (All those series obviously converge absolutely since $\Re(s) > 1$)
\end{proposition}
\begin{proof}
    By Prop.~\ref{prop:finite_sums_characters} we have for all $n \in \N$ that
    \begin{equation*}
        \frac 1 {q - 1} \sum_{\chi \in \mathrm{Dir}(q)} \overline{\chi(a)} \chi(n) = \begin{cases}
            1 & \text{if $a \equiv n \pmod q$} \\
            0 & \text{otherwise}
        \end{cases}
    \end{equation*}
    It follows that
    \begin{align*}
        \sum_{n \equiv a \ (\text{mod} \ q)} \Lambda(n) n^{-s} =& \sum_{n \geq 1} \Lambda(n) n^{-s} \begin{cases}
            1 & \text{if $a \equiv n \pmod q$} \\
            0 & \text{otherwise}
        \end{cases} \\
        =& \sum_{n \geq 1} \Lambda(n) n^{-s} \frac 1 {q - 1} \sum_{\chi \in \mathrm{Dir}(q)} \overline{\chi(a)} \chi(n) \\
        =& \frac 1 {q - 1} \sum_{\chi \in \mathrm{Dir}(q)} \overline{\chi(a)} \sum_{n \geq 1} \Lambda(n) \chi(n) n^{-s} 
    \end{align*}
    as infinite summation clearly commutes with finite sums.
\end{proof}
\begin{example}[Question (v)]
    \label{ex:nontrivial_dirichlet_characters_mod_5}
    We consider the Dirichlet characters mod 5.
    A (primitive) 5-th root of unity $\omega_5 \in \C$ is given by $\omega_5 = \exp(2\pi i/5)$.
    On the other hand, a primitive root modulo 5 is e.g. given by $r = 2$ since $2^2 \equiv -1 \pmod 5$.
    Thus we have the trivial Dirichlet character $\chi_0$ and $5 - 1 = 4$ nontrivial Dirichlet characters mod 5, namely those given by
    \begin{align*}
        \chi_1: 1 &\mapsto 1,\ 2 \mapsto \omega_5 = \exp(2\pi i/5),\ 3 \mapsto \omega_5^3 = \exp(6\pi i/5),\ 4 \mapsto \omega_5^2 = \exp(4\pi i/5),\ \\
        \chi_2: 1 &\mapsto 1,\ 2 \mapsto \omega_5^2 = \exp(4\pi i/5),\ 3 \mapsto \omega_5 = \exp(2\pi i/5),\ 4 \mapsto \omega_5^4 = \exp(8\pi i/5),\ \\
        \chi_3: 1 &\mapsto 1,\ 2 \mapsto \omega_5^3 = \exp(6\pi i/5),\ 3 \mapsto \omega_5^4 = \exp(8\pi i/5),\ 4 \mapsto \omega_5^1 = \exp(2\pi i/5),\ \\
        \chi_4: 1 &\mapsto 1,\ 2 \mapsto \omega_5^4 = \exp(8\pi i/5),\ 3 \mapsto \omega_5^2 = \exp(4\pi i/5),\ 4 \mapsto \omega_5^3 = \exp(6\pi i/5),\ \\
    \end{align*}
\end{example}

\section{Part III}
Again, let $q \geq 3$ be a prime.
Let further $\chi$ be a Dirichlet character mod $q$.
\begin{proposition}[Question (i)]
    \label{prop:logarithmic_derivative_L}
    For $\Re(s) > 1$ have that
    \begin{equation*}
        \frac {L(s, \chi)'} {L(s, \chi)} = \sum_{n \geq 1} \frac {\Lambda(n) \chi(n)} {n^s}
    \end{equation*}
\end{proposition}
\begin{proof}
    Consider any $\epsilon > 0$. The series
    \begin{equation*}
        \sum_{n \geq 1} \frac d {ds} \chi(n) n^{-s} = \sum_{n \geq 1} \chi(n) \log(n) n^{-s}
    \end{equation*}
    converges uniformly on $\Re(s) \geq 1 + \epsilon$, as $|\chi(n)| \leq C$ for some $C > 0$ and all $n \in \N$ (by the lecture, we know that $\sum_n \log(n) n^{-s}$ converges uniformly on $\Re(s) \geq 1 + \epsilon$).
    Hence, we may interchange summation and differentiation to get
    \begin{equation*}
        L(s, \chi)' = \sum_{n \geq 1} \chi(n) \frac d {ds} n^{-s} = \sum_{n \geq 1} \chi(n) \log(n) n^{-s}
    \end{equation*}
    for $\Re(s) \geq 1 + \epsilon$.
    As $\epsilon > 0$ was arbitrary, we get
    \begin{equation*}
        L(s, \chi)' = \sum_{n \geq 1} \chi(n) \log(n) n^{-s}
    \end{equation*}
    for all $\Re(s) > 1$.

    Furthermore, $\chi$ and $\mu$ are multiplicative, and hence so is $(\chi\mu)(n) := \chi(n)\mu(n)$.
    Thus we have the Euler products
    \begin{equation*}
        \sum_{n \geq 1} \mu(n) \chi(n) n^{-s} = \prod_{p \in \primes} \ \sum_{k \in \N} \mu(p^k) \chi(p^k) p^{-sk} = \prod_{p \in \primes} (1 - \chi(p)p^{-s})
    \end{equation*}
    and
    \begin{equation*}
        \sum_{n \geq 1} \chi(n) n^{-s} = \prod_{p \in \primes} \ \sum_{k \in \N} \chi(p^k) p^{-sk} = \prod_{p \in \primes} \frac 1 {1 - \chi(p)p^{-s}}
    \end{equation*}
    Everything converges absolutely for $\Re(s) > 1$, and so it follows
    \begin{equation*}
        \frac 1 {L(s, \chi)} = \sum_{n \geq 1} (\chi\mu)(n) n^{-s}
    \end{equation*}
    By the compatibility of Dirichlet convolution and Dirichlet summation, we now find
    \begin{equation*}
        L(s, \chi)' \frac 1 {L(s, \chi)} = \Bigl( \sum_{n \geq 1} \chi(n) \log(n) n^{-s} \Bigr) \Bigl( \sum_{n \geq 1} \chi(n) \mu(n) n^{-s} \Bigr) = \sum_{n \geq 1} (\chi\log * \chi\mu)(n) n^{-s}
    \end{equation*}
    and so it is left to show that $\chi\log * \chi\mu = \chi\Lambda$.

    This is true, as for all $n \in \N$ it holds
    \begin{align*}
        (\chi\log * \chi\mu)(n) &= \sum_{ab = n} \chi(a)\chi(b) \log(a)\mu(b) \\
        &= \sum_{ab = n} \chi(ab) \log(a)\mu(b) = \chi(n) \sum_{ab = n} \log(a) \mu(b) \\
        &= \chi(n) (\log * \mu)(n) = (\chi\Lambda)(n)
    \end{align*}
\end{proof}
Now we want to find an analytic continuation of $L(s, \chi)$ to $\Re(s) > 0$.
First of all, we consider $\chi_0$.
\begin{proposition}[Question (ii)]
    \label{prop:formula_trivial_L_series}
    For $\Re(s) > 1$ we have
    \begin{equation*}
        L(s, \chi_0) = (1 - q^{-s}) \zeta(s)
    \end{equation*}
    In particular, $L(s, \chi_0)$ has a meromorphic continuation to $\Re(s) > 0$ with only one simple pole at $s = 1$.
\end{proposition}
\begin{proof}
    As $\chi_0$ is fully multiplicative, we have the Euler product
    \begin{align*}
        L(s, \chi_0) =& \sum_{n \geq 1} \chi_0(n) n^{-s} = \prod_{p \in \primes} \frac 1 {1 - \chi_0(p)p^{-s}} = \prod_{p \neq q} \frac 1 {1 - p^{-s}} \\
        =& (1 - q^{-s}) \prod_{p \in \primes} \frac 1 {1 - p^{-s}} = (1 - q^{-s}) \zeta(s)
    \end{align*}
    as all products converge absolutely.
\end{proof}
For the other Dirichlet characters, the situation is slightly more complicated.
First, we will bound the value of the partial sums of a Dirichlet character.
\begin{lemma}[Question (iii)]
    \label{prop:bound_partsums_character}
    Let $\chi \neq \chi_0$ be a Dirichlet character mod $q$ and consider the sum function
    \begin{equation*}
        A(n) := \sum_{1 \leq k \leq n} \chi(k)
    \end{equation*}
    Then $|A(n)| \leq q$ for all $n \in \N$.
\end{lemma}
\begin{proof}
    Have
    \begin{align*}
        |A(n)| =& \ \Bigl| \sum_{1 \leq k \leq n} \chi(k) \Bigr| \leq \Bigl| \sum_{q\lfloor n/q \rfloor < l \leq n} \chi(l) \Bigr| + \Bigl| \sum_{0 \leq k < \lfloor n/q \rfloor} \ \underbrace{\sum_{0 < l \leq q} \chi(kq + l)}_{= 0 \ \text{by Prop.~\ref{prop:finite_sums_characters}}} \Bigr| \\
        =& \ \Bigl| \sum_{q\lfloor n/q \rfloor < l \leq n} \chi(l) \Bigr| \leq \sum_{q\lfloor n/q \rfloor < l \leq n} |\chi(l)| = \sum_{q\lfloor n/q \rfloor < l \leq n} 1 \\
        =& q(n/q - \lfloor n/q \rfloor) \leq q
    \end{align*}
    for all $n \in \N$.
\end{proof}
This bound is already strong enough to show the analytic continuation of $L(s, \chi)$ to $\Re(s) > 0$.
However, the best known results are significantly stronger than that.
\begin{proposition}[Pólya–Vinogradov inequality]
    Let $\chi \neq \chi_0$ be a Dirichlet character mod $q$. 
    Then for all $n \in \N$, have $|A(n)| = O(\sqrt{q}\log(q))$.
\end{proposition}
\begin{proof}
    See \cite[Ch. 23]{davenport}.
\end{proof}
Now we can show the analytic continuation of $L(s, \chi)$ to $\Re(s) > 0$.
\begin{proposition}[Question (iv)]
    Let $\chi \neq \chi_0$ be a Dirichlet character mod $q$.
    Then
    \begin{align*}
        L(s, \chi) = s \int_1^\infty A(t) t^{-(s + 1)} dt
    \end{align*}
    for $\Re(s) > 1$.
    Further, the right-hand side is a holomorphic function on $\Re(s) > 0$ and thus provides an analytic continuation of $L(s, \chi)$ to $\Re(s) > 0$.
\end{proposition}
\begin{proof}
    Using partial summation, we find for some $0 < \epsilon < 1$ that
    \begin{align*}
        \sum_{n \geq 1} \chi(n) n^{-s} =& A(1 - \epsilon) (1 - \epsilon)^{-s} - (-s) \int_{1 - \epsilon}^\infty A(t) t^{-(s + 1)} dt \\
        =& s \int_1^\infty A(t) t^{-(s + 1)} dt
    \end{align*}
    Further, the integral converges absolutely for $\Re(s) > 0$ and uniformly for $\Re(s) \geq \epsilon$ for all $\epsilon > 0$ by Lemma~\ref{prop:bound_partsums_character}.
    Thus it is holomorphic on $\Re(s) > 0$.
\end{proof}
\begin{corollary}[Question (iv)]
    \label{prop:logarithmic_derivative_L_bounded}
    The function $L(s, \chi)'/L(s, \chi)$ is bounded on a neighborhood of $1$, provided that $L(1, \chi) \neq 0$.
\end{corollary}
\begin{proof}
    As $L(s, \chi)'/L(s, \chi)$ is meromorphic on $\Re(s) > 0$, we know that it is holomorphic on some neighborhood of $1$ unless it has a pole at $s = 1$.
    In the third exercise class of ANT, it was shown that this would imply $L(1, \chi) = 0$ or $L(s, \chi)'$ has a pole at $s = 1$.

    However, the derivative of a holomorphic function is again holomorphic, so $L(s, \chi)'$ has no pole at $s = 1$.
    Provided that $L(1, \chi) \neq 0$, it follows that $L(s, \chi)'/L(s, \chi)$ is holomorphic on a compact neighborhood of $1$, so bounded.
\end{proof}
Now we can show the main result of this miniproject.
We will prove two auxiliary lemmas before.
\begin{lemma}
    \label{prop:rho_pole_at_one}
    For $a \perp q$, the function
    \begin{equation*}
        \rho_a(s) := \frac 1 {q - 1} \sum_{\chi \in \mathrm{Dir}(q)} \overline{\chi(a)} \sum_{n \geq 1} \frac {\Lambda(n) \chi(n)} {n^s}
    \end{equation*}
    defined on $\Re(s) > 1$ has a meromorphic continuation to $\Re(s) > 0$ with a simple poles at $1$ (and possibly other poles on $\Re(s) > 0$), provided that $L(\chi, 1) \neq 0$ for all $\chi \in \mathrm{Dir}(q) \setminus \{ \chi_0 \}$.
\end{lemma}
\begin{proof}
    By Prop.~\ref{prop:logarithmic_derivative_L}, we have for $\chi \in \mathrm{Dir}(q)$ and $\Re(s) > 1$ that
    \begin{equation*}
        \frac {\overline{\chi(a)}} {q - 1} \sum_{n \geq 1} \frac {\Lambda(n) \chi(n)} {n^s} = \frac {\overline{\chi(a)}} {q - 1} \frac {L(s, \chi)'} {L(s, \chi)}
    \end{equation*}
    Hence
    \begin{equation*}
        \rho_a(s) := \frac 1 {q - 1} \sum_{\chi \in \mathrm{Dir}(q)} \overline{\chi(a)} \frac {L(s, \chi)'} {L(s, \chi)}
    \end{equation*}
    for $\Re(s) > 1$ and the right-hand side is a meromorphic continuation of $\rho_a(s)$ to $\Re(s) > 0$.

    If $\chi \neq \chi_0$, then Corollary~\ref{prop:logarithmic_derivative_L_bounded} shows that the function
    \begin{equation*}
        \frac {\overline{\chi(a)}} {q - 1} \cdot \frac {L(s, \chi)'} {L(s, \chi)}
    \end{equation*}
    has no pole at $s = 1$.
    
    If $\chi = \chi_0$ on the other hand, Prop.~\ref{prop:formula_trivial_L_series} shows that
    \begin{equation*}
        L(s, \chi_0) = (1 - q^{-s}) \zeta(s)
    \end{equation*}
    Hence
    \begin{equation*}
        \frac {L(s, \chi_0)'} {L(s, \chi_0)} = \frac { \log(q)q^{-s} \zeta(s) + (1 - q^{-s}) \zeta'(s) } { (1 - q^{-s})\zeta(s) } = \frac {\log(q)} {q^s - 1} + \frac {\zeta'(s)} {\zeta(s)}
    \end{equation*}
    has a simple pole at $s = 1$.
    Since $a \perp q$, we see that $\chi_0(a) = 1$ and thus also
    \begin{equation*}
        \frac {\overline{\chi_0(a)}} {q - 1} \cdot \frac {L(s, \chi_0)'} {L(s, \chi_0)}
    \end{equation*}
    has a simple pole at $s = 1$.

    Together, this yields that the sum of those functions
    \begin{equation*}
        \rho_a(s) = \frac 1 {q - 1} \sum_{\chi \in \mathrm{Dir}(q)} \overline{\chi(a)} \sum_{n \geq 1} \frac {L(\chi, s)'} {L(\chi, s)}
    \end{equation*}
    is a meromorphic function with a simple pole at $s = 1$.
\end{proof}
\begin{lemma}
    \label{prop:correlation_theta_Psi}
    Let $a \perp q$ and define
    \begin{equation*}
        \Psi_a(x) := \sum_{n < x, \ n \equiv a \ (\text{mod} \ q)} \Lambda(n)
    \end{equation*}
    and
    \begin{equation*}
        \theta_a(x) := \sum_{p < x, \ p \equiv a \ (\text{mod} \ q)} \log(p)
    \end{equation*}
    Then
    \begin{equation*}
        \Psi_a(x) - \theta_a(x) = O(x^{1/2}\log(x))
    \end{equation*}
\end{lemma}
\begin{proof}
    Have
    \begin{align*}
        \Psi_a(x) - \theta_a(x) =& \sum_{p^k < x, \ p^k \equiv a \ (\text{mod} \ q)} \log(p) - \sum_{p < x, \ p \equiv a \ (\text{mod} \ q)} \log(p) \\
        =& \sum_{p^k < x, \ k \geq 2, \ p^k \equiv a \ (\text{mod} \ q)} \log(p) \leq \sum_{p^k < x, \ k \geq 2} \log(p) \\
        =& \Psi(x) - \theta(x) = O(x^{1/2}\log(x))
    \end{align*}
    where the last equality was proven in the lecture.
\end{proof}
\begin{proposition}[Question (v)]
    \label{prop:infinite_primes_congruent}
    Assume that $L(1, \chi) \neq 0$ for all $\chi \in \mathrm{Dir}(q) \setminus \{ \chi_0 \}$.
    Then for all $a \perp q$ there are infinitely many primes $p \equiv a \pmod q$.
\end{proposition}
\begin{proof}
    Assume not, then $\theta_a(x)$ is bounded, i.e. $\theta_a(x) = O(1)$.
    With Lemma~\ref{prop:correlation_theta_Psi} it follows that $\Psi_a(x) = O(x^{1/2} \log x)$.

    By Prop.~\ref{prop:representation_mangoldt_series_congruent_a} we have that for $\Re(s) > 1$
    \begin{equation*}
        \rho_a(s) = \sum_{n \equiv a \ (\text{mod} \ q)} \Lambda(n) n^{-s}
    \end{equation*}
    Partial summation yields that for $\Re(s) > 1$ have
    \begin{align*}
        \rho_a(s) =& \sum_{n \equiv a \ (\text{mod} \ q)} \Lambda(n) n^{-s} \\
        =& \lim_{t \to \infty} \Bigl( \underbrace{ t^{-s} \sum_{n < t, \ n \equiv a \ (\text{mod} \ q)} \Lambda(n) }_{ = t^{-s} \Psi_a(t) = t^{-s} O(t\log t) = o(1)} \Bigr) 
        + s \int_1^\infty \Bigl( \underbrace{\sum_{n < t, \ n \equiv a \ (\text{mod} \ q)} \Lambda(n) }_{ = \Psi_a(t)} \Bigr) t^{-(s + 1)} dt \\
        =& s \int_1^\infty \Psi_a(t) t^{-s - 1} dt = s \int_1^\infty O(t^{1/2}\log t) t^{-s - 1} dt \\
        =& O\left( |s| \int_1^\infty \log(t) t^{-\Re(s) - 1/2} dt \right) \\
        =& O\left( |s| \left( \frac 1 {1/2 - \Re(s)} 1^{1/2 - \Re(s)} + \frac 1 {1/2 - \Re(s)} \int_1^\infty t^{-\Re(s) - 1/2} dt \right) \right) \\
        =& O\left( |s| \frac 1 {(1/2 - \Re(s))^2} \right)
    \end{align*}
    However this function has no pole at $s = 1$, a contradiction to Lemma~\ref{prop:rho_pole_at_one}.
\end{proof}
\begin{example}[Question (vi)]
    For all the nontrivial Dirichlet characters $\chi_1, ..., \chi_4$ defined in Example~\ref{ex:nontrivial_dirichlet_characters_mod_5}, we have
    \begin{equation*}
        L(1, \chi_i) \neq 0
    \end{equation*}
    It follows that there are infinitely many primes $\equiv a \pmod 5$, for all $a \perp 5$.
\end{example}
\begin{proof}
    By Prop.~\ref{prop:dirichlet_series_at_one} we know that
    \begin{equation*}
        L(1, \chi_i) = \sum_{n \geq 1} \chi(n) n^{-s}
    \end{equation*}
    For the fifth root of unity $\omega \in \C$ such that $\chi_i(1) = \omega$, we thus find
    \begin{align*}
        L(1, \chi_i) =& \sum_{k \geq 0} \sum_{1 \leq n \leq 4} \frac {\chi(5k + n)} {(5k + n)^s} = \sum_{k \geq 0} \frac {\omega} {(5k + 1)^s} + \frac {\omega^2} {(5k + 2)^s} + \frac {\omega^3} {(5k + 3)^s} + \frac {\omega^4} {(5k + 4)^s} \\
        =& \sum_{k \geq 0} \omega \Bigl( \underbrace{\frac 1 {(5k + 1)^s} - \frac 1 {(5k + 4)^s}}_{> 0} \Bigr) + \omega^2 \Bigl( \underbrace{\frac 1 {(5k + 2)^s} - \frac 1 {(5k + 3)^s}}_{> 0} \Bigr)
    \end{align*}
    Hence we have positive coefficients $a_k, b_k > 0$ with
    \begin{equation*}
        L(1, \chi_i) - \sum_{k \geq 0} a_k \omega + b_k \omega^2 = \omega \sum_{k \geq 0} a_k + b_k \omega
    \end{equation*}
    In particular,
    \begin{equation*}
        \Im\left( \frac {L(1, \chi_i)} {\omega} \right) = \sum_{k \geq 0} b_k \Im(\omega) = \Im(\omega) \underbrace{ \sum_{k \geq 0} b_k }_{> 0}
    \end{equation*}
    Since $\chi_i$ is a nontrivial Dirichlet character, we see that $\Im(\omega) \neq 0$ and so $\Im(L(1, \chi_i)/\omega) \neq 0$, thus $L(1, \chi_i) \neq 0$.
    The claim now follows by Prop.~\ref{prop:infinite_primes_congruent}.
\end{proof}
Finally, we want to reflect on the general approach and highlight how we used of Dirichlet characters.
\begin{remark}[Question (vii)]
    Roughly speaking, both the approach used in the lecture and in this Miniproject consists of three steps.
    \begin{itemize}
        \item Relate the frequency of considered primes to the poles of a Dirichlet series, using partial summation or Perron's formula.

        \item Express the above series as logarithmic derivative of a second function.
        This then relates poles to zeros, by the properties of the Taylor series expansion of meromorphic functions.

        \item Investigate the zeros of the second function.
    \end{itemize}

    It seems like the magic happens mostly in the second step.
    The crucial part here is the connection between multiplicative arithmetic and Dirichlet series.
    In particular, this gives us nice identities like the Euler product.
    However, this will be completely destroyed when we consider functions that are not multiplicative at all.

    More concretely, consider
    \begin{equation*}
        f: \N \to \C, \quad n \mapsto \begin{cases}
            1 & \text{if $n \equiv a \pmod q$} \\
            0 & \text{otherwise}
        \end{cases}
    \end{equation*}
    Note that this function is not multiplicative.
    After applying the first step, we are interested in the poles of the meromorphic function
    \begin{equation*}
        \sum_{n \geq 1} f(n) \Lambda(n) n^{-s}
    \end{equation*}
    However, here we get stuck.
    It might seem natural to consider the function
    \begin{equation*}
        \zeta_a(s) := \sum_{n \geq 1} f(n) n^{-s}
    \end{equation*}
    which has a meromorphic continuation to $\Re(s) > 0$ (I will not prove this here).
    Its derivative is clearly given by
    \begin{equation*}
        \zeta_a'(s) = \sum_{n \geq 1} f(n) \log(n) n^{-s}
    \end{equation*}
    To continue, we might try to consider
    \begin{equation*}
        \zeta_a'(s)\Bigl( \sum_{n \geq 1} \mu(n) f(n) n^{-s} \Bigr) = \sum_{n \geq 1} \frac {(f\log * f\mu)(n)} {n^s}
    \end{equation*}
    But since $f$ has no nice compatibility with multiplication or $*$, it is not easy to make something of this.
    In particular
    \begin{equation*}
        f\Lambda \neq f\log * f\mu \quad \text{and} \quad \frac 1 {\zeta_a(s)} \neq \sum_{n \geq 1} f(n) \mu(n) n^{-s}
    \end{equation*}
    Note that we find $n \equiv a \pmod q$ such that $n$ has no nontrivial factor $\equiv a \pmod q$.
    E.g. take $n = 9 \equiv 4 \pmod 5$, then
    \begin{equation*}
        \log(3) = (f\Lambda)(6) \neq \sum_{cd = 9} f(c)\log(c)f(d)\mu(d) = 0
    \end{equation*}
    Furthermore, the equality
    \begin{equation*}
        \frac 1 {\zeta_a(s)} = \sum_{n \geq 1} f(n) \mu(n) n^{-s}
    \end{equation*}
    would imply
    \begin{equation*}
        1 = \zeta_a(s) \sum_{n \geq 1} f(n) \mu(n) n^{-s} = \sum_{n \geq 1} \frac {(f * f\mu)(n)} {n^s}
    \end{equation*}
    which in turns implies that $f * f\mu = \delta$.
    However, we clearly find counterexamples for that, e.g. for $q = 5, a = 4$ find $(f * f\mu)(1) = 0$.
    The underlying reason is that the divisors of $n$ may lie in a different congruence class modulo $q$ than $n$.

    In some sense, this whole miniproject was just about using the decomposition
    \begin{equation*}
        f = \frac 1 {q - 1} \sum_{\chi \in \mathrm{Dir}(q)} \overline{\chi(a)} \chi
    \end{equation*}
    as then the Dirichlet series become Dirichlet series over $\chi$ instead of $f$, which is much better manageable.
\end{remark}

\printbibliography
\end{document}